scripted_gui = {
	#|=|========[ Main GUI ]========|=|#
	TTW_Espionage_DecisionGui = {
		context_type = player_context
		parent_window_name = powerbalanceview
		window_name = "TTW_Espionage_GUI"
		visible = {
			check_variable = { TTW_BoP_SelectedTab = token:BoP_Tab_Espionage }
		}


		effects = {
			# Info Button
			Espionage_GUI_InfoBtn_click = {
				if = {
					limit = { has_country_flag = TTW_Espionage_LeaderInfoGUI_Open }
					clr_country_flag = TTW_Espionage_LeaderInfoGUI_Open
				}
				else = {
					set_country_flag = TTW_Espionage_LeaderInfoGUI_Open
				}
			}

			# Budget Control Buttons
			Espionage_GUI_Budget_IncreaseBtn_click = {
				add_to_variable = { TTW_Espionage_Investment = 0.005 }
				add_to_variable = { TTW_Espionage_max_command_power = -5 }
				force_update_dynamic_modifier = yes
			}
			Espionage_GUI_Budget_DecreaseBtn_click = {
				add_to_variable = { TTW_Espionage_Investment = -0.005 }
				add_to_variable = { TTW_Espionage_max_command_power = 5 }
				force_update_dynamic_modifier = yes
			}

			# Research GUI Button
			Espionage_GUI_ResearchBtn_click = {
				if = {
					limit = { has_country_flag = TTW_Espionage_ResearchGUI_Open }
					clr_country_flag = TTW_Espionage_ResearchGUI_Open
				}
				else = {
					set_country_flag = TTW_Espionage_ResearchGUI_Open
				}
			}

			# Recruitment Button
			Espionage_GUI_Capability_InvestBtn_click = {
				hidden_effect = {
					add_command_power = -10
					add_manpower = -10
				}
				add_to_variable = { TTW_Espionage_Expertise = 10 tooltip = TTW_Espionage_AddExpertise_tt }
				clamp_variable = { var = TTW_Espionage_Expertise min = 0 max = 100 }
			}
			Espionage_GUI_Training_RecruitBtn_click = {
				subtract_from_variable = { TTW_Espionage_Budget = 0.015 }
				subtract_from_variable = { TTW_Espionage_Expertise = 50 }
				custom_effect_tooltip = TTW_Espionage_RecruitmentWillBegin_tt
				hidden_effect = {
					country_event = TTW_Espionage.2
					country_event = { id = TTW_Espionage.4 days = 10 }
					country_event = { id = TTW_Espionage.3 days = 100 }
					set_country_flag = TTW_Espionage_IsRecruiting
				}
			}

		}


		#|=|========[ AI CODE ]========|=|#
		ai_enabled = { TTW_Espionage_AllowedTags = yes }
		ai_check = { has_country_flag = TTW_Espionage_Mech_Active }

		ai_test_interval = 720
		ai_max_weight_taken_per_test = 6

		ai_weights = {
			Espionage_GUI_Budget_IncreaseBtn_click = {
				ai_will_do = { base = 5 }
				weight = 1
			}
		}
	}


}
